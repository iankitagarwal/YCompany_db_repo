// Use DBML to define your database structure
// Docs: https://dbml.dbdiagram.io/docs

Table users {
  user_id integer [primary key]
  username varchar
  is_internal_user boolean
  email varchar
  mobile_number varchar
  address1 varchar
  address2 varchar
  city_id varchar
  state_id integer
  country_id integer
  zipcode1 varchar
  zipcode2 varchar 
  active boolean
  created_at timestamp
  updated_at timestamp
  created_by varchar
  updated_by varchar
}

Table vehicles{
  vehicle_id integer [primary key]
  model varchar
  user_id integer [ref: > users.user_id]
  vehicle_type_id integer [unique, ref: - vehicle_type.vehicle_type_id]
  registration_number varchar
  registration_date date
  owner_name varchar
  engine_type_id integer [unique, ref: - engine_type.engine_type_id]
  owner_type_id integer [unique, ref: - owner_type.owner_type_id]
} 

Table vehicle_type{
  vehicle_type_id integer
  type varchar
}

Table engine_type{
  engine_type_id integer
  type varchar
}

Table owner_type{
  owner_type_id integer
  type varchar
}

Table roles {
  role_id integer [primary key]
  rolename varchar
}

Table user_role_mapping{
  user_role_mapping_id integer
  user_id integer
  role_id integer
  created_at timestamp
  updated_at timestamp
  created_by varchar
  updated_by varchar
}

Table user_policies{
  user_policy_id integer
  user_id integer [ref: > users.user_id]
  vehicle_id integer [unique, ref: - vehicles.vehicle_id]
  policy_id integer
  policy_number varchar
  start_date date
  end_date date
  last_activation_date date
  is_renewed boolean
  active boolean
  last_policy_number varchar
}

Table country{
  country_id integer
  country_code varchar
  country_name varchar
  created_at timestamp
}

Table state{
  state_id integer
  state_code varchar
  state_name varchar
  country_id integer [ref: > country.country_id]
  created_at timestamp
}

Table city{
  city_id integer
  city_code varchar
  city_name varchar
  state_id integer [ref: > state.state_id]
  country_id integer [ref: > country.country_id]
  created_at timestamp
}


Table policy{
  policy_id integer
  policy_name varchar
  country_id integer [ref: > country.country_id]
  state_id integer [ref: > state.state_id]
  policy_duration varchar
  active boolean
  policy_type_id integer
  created_at timestamp
  updated_at timestamp
  created_by varchar
  updated_by varchar
}

Table policy_types{
  policy_type_id integer
  policy_id integer [unique, ref: - policy.policy_id]
  policy_type_name varchar
}

Table policy_document_links {
  policy_document_links_id integer
  policy_id integer [ref: > policy.policy_id]
  document_link varchar
}
Table workshop{
  workshop_id integer
  workshop_name varchar
  address1 varchar
  address2 varchar
  country_id integer [ref: - country.country_id]
  state_id integer [ref: - state.state_id]
  city_id integer [ref: - city.city_id]
  is_partner_workshop boolean
}

Table car_rental_partner{
  car_rental_partner_id integer
  car_rental_partner_name varchar
  address1 varchar
  address2 varchar
  country_id integer
  state_id integer
  city_id integer
}

Table rental_cars{
  rental_car_id integer
  model varchar
  car_rental_partner_id integer [ref: > car_rental_partner.car_rental_partner_id]
  engine_type_id integer [unique, ref: - engine_type.engine_type_id]
  vehicle_type_id integer [unique, ref: - vehicle_type.vehicle_type_id]
  rent_per_day decimal
  is_available boolean
  start_date timestamp
  end_date timestamp
}
